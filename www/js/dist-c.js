!function(n,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):n.printStackTrace=e()}(this,function(){function n(e){e=e||{guess:!0};var t=e.e||null,r=!!e.guess,o=e.mode||null,c=new n.implementation,s=c.run(t,o);return r?c.guessAnonymousFunctions(s):s}return n.implementation=function(){},n.implementation.prototype={run:function(n,e){return n=n||this.createException(),e=e||this.mode(n),"other"===e?this.other(arguments.callee):this[e](n)},createException:function(){try{this.undef()}catch(n){return n}},mode:function(n){return"undefined"!=typeof window&&window.navigator.userAgent.indexOf("PhantomJS")>-1?"phantomjs":n.arguments&&n.stack?"chrome":n.stack&&n.sourceURL?"safari":n.stack&&n.number?"ie":n.stack&&n.fileName?"firefox":n.message&&n["opera#sourceloc"]?n.stacktrace?n.message.indexOf("\n")>-1&&n.message.split("\n").length>n.stacktrace.split("\n").length?"opera9":"opera10a":"opera9":n.message&&n.stack&&n.stacktrace?n.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":n.stack&&!n.fileName?"chrome":"other"},instrumentFunction:function(e,t,r){e=e||window;var o=e[t];e[t]=function(){return r.call(this,n().slice(4)),e[t]._instrumented.apply(this,arguments)},e[t]._instrumented=o},deinstrumentFunction:function(n,e){n[e].constructor===Function&&n[e]._instrumented&&n[e]._instrumented.constructor===Function&&(n[e]=n[e]._instrumented)},chrome:function(n){return(n.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},safari:function(n){return n.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(n){return n.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},firefox:function(n){return n.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,"{anonymous}($1)@").split("\n")},opera11:function(n){for(var e="{anonymous}",t=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,r=n.stacktrace.split("\n"),o=[],c=0,s=r.length;s>c;c+=2){var a=t.exec(r[c]);if(a){var i=a[4]+":"+a[1]+":"+a[2],u=a[3]||"global code";u=u.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,e),o.push(u+"@"+i+" -- "+r[c+1].replace(/^\s+/,""))}}return o},opera10b:function(n){for(var e=/^(.*)@(.+):(\d+)$/,t=n.stacktrace.split("\n"),r=[],o=0,c=t.length;c>o;o++){var s=e.exec(t[o]);if(s){var a=s[1]?s[1]+"()":"global code";r.push(a+"@"+s[2]+":"+s[3])}}return r},opera10a:function(n){for(var e="{anonymous}",t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=n.stacktrace.split("\n"),o=[],c=0,s=r.length;s>c;c+=2){var a=t.exec(r[c]);if(a){var i=a[3]||e;o.push(i+"()@"+a[2]+":"+a[1]+" -- "+r[c+1].replace(/^\s+/,""))}}return o},opera9:function(n){for(var e="{anonymous}",t=/Line (\d+).*script (?:in )?(\S+)/i,r=n.message.split("\n"),o=[],c=2,s=r.length;s>c;c+=2){var a=t.exec(r[c]);a&&o.push(e+"()@"+a[2]+":"+a[1]+" -- "+r[c+1].replace(/^\s+/,""))}return o},phantomjs:function(n){for(var e="{anonymous}",t=/(\S+) \((\S+)\)/i,r=n.stack.split("\n"),o=[],c=1,s=r.length;s>c;c++){r[c]=r[c].replace(/^\s+at\s+/gm,"");var a=t.exec(r[c]);a?o.push(a[1]+"()@"+a[2]):o.push(e+"()@"+r[c])}return o},other:function(n){for(var e,t,r="{anonymous}",o=/function(?:\s+([\w$]+))?\s*\(/,c=[],s=10,a=Array.prototype.slice;n&&c.length<s;){e=o.test(n.toString())?RegExp.$1||r:r;try{t=a.call(n.arguments||[])}catch(i){t=["Cannot access arguments: "+i]}c[c.length]=e+"("+this.stringifyArguments(t)+")";try{n=n.caller}catch(i){c[c.length]="Cannot access caller: "+i;break}}return c},stringifyArguments:function(n){for(var e=[],t=Array.prototype.slice,r=0;r<n.length;++r){var o=n[r];void 0===o?e[r]="undefined":null===o?e[r]="null":o.constructor&&(o.constructor===Array?o.length<3?e[r]="["+this.stringifyArguments(o)+"]":e[r]="["+this.stringifyArguments(t.call(o,0,1))+"..."+this.stringifyArguments(t.call(o,-1))+"]":o.constructor===Object?e[r]="#object":o.constructor===Function?e[r]="#function":o.constructor===String?e[r]='"'+o+'"':o.constructor===Number?e[r]=o:e[r]="?")}return e.join(",")},sourceCache:{},ajax:function(n){var e=this.createXMLHTTPObject();if(e)try{return e.open("GET",n,!1),e.send(null),e.responseText}catch(t){}return""},createXMLHTTPObject:function(){for(var n,e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=0;t<e.length;t++)try{return n=e[t](),this.createXMLHTTPObject=e[t],n}catch(r){}},isSameDomain:function(n){return"undefined"!=typeof location&&-1!==n.indexOf(location.hostname)},getSource:function(n){return n in this.sourceCache||(this.sourceCache[n]=this.ajax(n).split("\n")),this.sourceCache[n]},guessAnonymousFunctions:function(n){for(var e=0;e<n.length;++e){var t=/\{anonymous\}\(.*\)@(.*)/,r=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,o=n[e],c=t.exec(o);if(c){var s=r.exec(c[1]);if(s){var a=s[1],i=s[2],u=s[3]||0;if(a&&this.isSameDomain(a)&&i){var l=this.guessAnonymousFunction(a,i,u);n[e]=o.replace("{anonymous}",l)}}}}return n},guessAnonymousFunction:function(n,e,t){var r;try{r=this.findFunctionName(this.getSource(n),e)}catch(o){r="getSource failed with url: "+n+", exception: "+o.toString()}return r},findFunctionName:function(n,e){for(var t,r,o,c=/function\s+([^(]*?)\s*\(([^)]*)\)/,s=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,a=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,i="",u=Math.min(e,20),l=0;u>l;++l)if(t=n[e-l-1],o=t.indexOf("//"),o>=0&&(t=t.substr(0,o)),t){if(i=t+i,r=s.exec(i),r&&r[1])return r[1];if(r=c.exec(i),r&&r[1])return r[1];if(r=a.exec(i),r&&r[1])return r[1]}return"(?)"}},n});